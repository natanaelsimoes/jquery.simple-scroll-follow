/**
 * @file jquery.simple-scroll-follow
 * @version 3.1.1
 * @author Yuusaku Miyazaki <toumin.m7@gmail.com>
 * @license MIT
 */
!function(o){"object"==typeof module&&"object"==typeof module.exports?o(require("jquery"),window,document):o(jQuery,window,document)}(function(l,i,o,t){l.fn.simpleScrollFollow=function(o){var t=Array.prototype.slice.call(arguments,1);return this.each(function(){l.fn.simpleScrollFollow.processEach(this,o,t)})},l.fn.simpleScrollFollow.processEach=function(o,t,e){var i=l(o).data("simple-scroll-follow");return i&&t in i&&"_"!=t.charAt(0)?(i[t].apply(i,e),"call public method"):"object"!=typeof t&&t?(console.error('Sub-method "'+t+'" does not exist on $.simpleScrollFollow'),"error"):(l(o).data("simple-scroll-follow",new l.simpleScrollFollow(o,t)),"init plugin")},l.simpleScrollFollow=function(o,t){this._setOption(t),this._setFollow(o);var e=this;l(i).scroll(function(){e._handleScroll.call(e)}),this.timer=!1,l(i).resize(function(){e._handleResize.call(e)})},l.extend(l.simpleScrollFollow.prototype,{setEnabled:function(o){return o===t||o?this.option.enabled=!0:(this._moveDefaultPosition(),this.option.enabled=!1)},_moveDefaultPosition:function(){l(this.follow.elem).css({position:"",top:"",bottom:"",left:"",right:""}).width("")},_setFollow:function(o){return this.follow={elem:o,width:l(o).width(),offset_top:l(o).offset().top,offset_bottom:this._calcOffsetBottom(o),offset_left:l(o).offset().left,position_top:"auto"==l(o).css("top")?0:Number(l(o).css("top").replace(/px$/,""))}},_setOption:function(o){return this.option=l.extend({enabled:!0,limit_elem:l("body"),min_width:0,upper_side:null,lower_side:null},o),"string"==typeof this.option.limit_elem&&(this.option.limit_elem=l(this.option.limit_elem)),this.option},_calcOffsetBottom:function(o){return l(o).offset().top+this._calcElemHeight(o)},_calcElemHeight:function(o){return l(o).height()+Number(l(o).css("border-top-width").replace(/px$/,""))+Number(l(o).css("border-bottom-width").replace(/px$/,""))+Number(l(o).css("padding-top").replace(/px$/,""))+Number(l(o).css("padding-bottom").replace(/px$/,""))},_handleScroll:function(){if(!this.option.enabled)return!1;if(l(i).width()<this.option.min_width)return this._moveDefaultPosition.call(this),!1;this._getUpperSide(),this._getLowerSide();var o={offset_top:l(this.follow.elem).offset().top,offset_bottom:this._calcOffsetBottom(this.follow.elem)},t={offset_bottom:this._calcOffsetBottom(this.option.limit_elem)};return!(t.offset_bottom-this.follow.offset_top<o.offset_bottom-o.offset_top)},_getUpperSide:function(){var o=l(i).scrollTop();if(this.option.upper_side){var t=this._calcOffsetBottom(this.option.upper_side);o<t&&(o=t)}return o},_getLowerSide:function(){var o=l(i).scrollTop()+l(i).height();if(this.option.lower_side){var t=l(this.option.lower_side).offset().top;t<o&&(o=t)}return o},_handleScrollMain:function(o,t,e){return o.scroll_top<this.follow.offset_top?(this._move1(),1):o.scroll_top>e.offset_bottom?(this._move2(t,e),2):o.scroll_bottom-o.scroll_top>t.offset_bottom-t.offset_top?e.offset_bottom-o.scroll_top<t.offset_bottom-t.offset_top?(this._move2(t,e),3):(this._move3(),4):o.scroll_bottom>e.offset_bottom?(this._move2(t,e),5):o.scroll_bottom-this.follow.offset_top>t.offset_bottom-t.offset_top?(this._move4(),6):(this._move1(),7)},_move1:function(){l(this.follow.elem).css({position:"absolute",top:"",bottom:"",left:"",right:""}).width(this.follow.width)},_move2:function(o,t){l(this.follow.elem).css({position:"absolute",top:t.offset_bottom-this.follow.offset_top-(o.offset_bottom-o.offset_top)+this.follow.position_top,bottom:"auto",left:-i.pageXOffset,right:""}).width(this.follow.width)},_move3:function(){l(this.follow.elem).css({position:"fixed",top:this._getPositionToStickToWindow(this.option.upper_side),bottom:"auto",left:-i.pageXOffset,right:"auto"}).width(this.follow.width)},_move4:function(){l(this.follow.elem).css({position:"fixed",top:"auto",bottom:this._getPositionToStickToWindow(this.option.lower_side),left:-i.pageXOffset,right:"auto"}).width(this.follow.width)},_getPositionToStickToWindow:function(o){return o?this._calcElemHeight(o):0},_handleResize:function(){!1!==this.timer&&clearTimeout(this.timer);var o=this;return this.timer=setTimeout(function(){o._moveDefaultPosition.call(o),o._setFollow.call(o,o.follow.elem),l(i).trigger("scroll")},200)}})});